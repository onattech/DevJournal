"use strict";(self.webpackChunkdev_journal=self.webpackChunkdev_journal||[]).push([[2661],{6093:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>u,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var i=n(3010),s=n(2803);const o={sidebar_position:1,title:"CI with Github Actions"},a="Continuous integration with Github Actions",r={unversionedId:"tutorial-docusaurus/ci-with-github-actions",id:"tutorial-docusaurus/ci-with-github-actions",title:"CI with Github Actions",description:"Below is a workflow YAML to deploy a Docusaurus site with pnpm to GitHub Pages via GitHub Actions. An action to deploy will be triggered on each push to the main branch.",source:"@site/docs/tutorial-docusaurus/ci-with-github-actions.md",sourceDirName:"tutorial-docusaurus",slug:"/tutorial-docusaurus/ci-with-github-actions",permalink:"/docs/tutorial-docusaurus/ci-with-github-actions",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"CI with Github Actions"},sidebar:"tutorialSidebar",previous:{title:"Getting started with Docusaurus",permalink:"/docs/tutorial-docusaurus/intro"},next:{title:"Algolia setup",permalink:"/docs/tutorial-docusaurus/algolia-setup"}},u={},c=[{value:"Steps to follow",id:"steps-to-follow",level:3},{value:"Set workflow permissions",id:"set-workflow-permissions",level:3}];function l(t){const e=Object.assign({h1:"h1",p:"p",h3:"h3",ol:"ol",li:"li",pre:"pre",code:"code",img:"img"},(0,s.ah)(),t.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"continuous-integration-with-github-actions",children:"Continuous integration with Github Actions"}),"\n",(0,i.jsx)(e.p,{children:"Below is a workflow YAML to deploy a Docusaurus site with pnpm to GitHub Pages via GitHub Actions. An action to deploy will be triggered on each push to the main branch."}),"\n",(0,i.jsx)(e.h3,{id:"steps-to-follow",children:"Steps to follow"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Add the YAML file to the project directory."}),"\n",(0,i.jsx)(e.li,{children:"Setup a token on Github."}),"\n",(0,i.jsx)(e.li,{children:"Make a push to the main branch."}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",metastring:'title="./.github/workflows/deploy.yml"',children:"name: Deploy to GitHub Pages\n\non:\n    push:\n        branches:\n            - main\n        # Review gh actions docs if you want to further define triggers, paths, etc\n        # https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#on\n#\njobs:\n    deploy:\n        name: Deploy to GitHub Pages\n        runs-on: ubuntu-latest\n        steps:\n            - uses: actions/checkout@v3\n            - uses: pnpm/action-setup@v2.2.4\n              with:\n                  version: 7\n\n            - name: \ud83d\udce6 Cache pnpm and node_modules\n              uses: actions/cache@v3\n              with:\n                  path: |\n                      ~/.pnpm-store\n                      node_modules\n                  key: pnpm-${{ hashFiles('**/pnpm-lock.yaml') }}\n                  restore-keys: pnpm-\n\n            - name: \ud83d\udddc\ufe0f Install dependencies\n              run: pnpm install --no-frozen-lockfile\n            - name: \ud83c\udfd7 Build website\n              run: pnpm run build\n\n            # Optional\n            - name: \ufe0f\ud83c\udff7 Add commit hash to <html> tag\n              run: |\n                  COMMIT_HASH=$(echo ${{ github.sha }} | cut -c 1-7)\n                  sed -i 's/<html /<html data-commit-hash=\"'\"$COMMIT_HASH\"'\" /' ./build/index.html\n\n            # Popular action to deploy to GitHub Pages:\n            # Docs: https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-docusaurus\n            - name: Deploy to GitHub Pages\n              uses: peaceiris/actions-gh-pages@v3\n              with:\n                  github_token: ${{ secrets.GITHUB_TOKEN }}\n                  # Build output to publish to the `gh-pages` branch:\n                  publish_dir: ./build\n                  # The following lines assign commit authorship to the official\n                  # GH-Actions bot for deploys to `gh-pages` branch:\n                  # https://github.com/actions/checkout/issues/13#issuecomment-724415212\n                  # The GH actions bot is used by default if you didn't specify the two fields.\n                  # You can swap them out with your own user credentials.\n                  user_name: ${{ github.event.pusher.name }}\n                  user_email: ${{ github.event.pusher.email }}\n# Give permission to workflow => https://stackoverflow.com/a/75308228\n"})}),"\n",(0,i.jsx)(e.h3,{id:"set-workflow-permissions",children:"Set workflow permissions"}),"\n",(0,i.jsxs)(e.p,{children:["Github actions needs permissions to commit to the repository. You may give necessary permission by going to ",(0,i.jsx)(e.code,{children:"Settings -> Actions -> General -> Workflow permissions"})," and selecting ",(0,i.jsx)(e.code,{children:"Read and write permissions"})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Workflow permissions",src:n(4390).Z+"",width:"1299",height:"1215"})})]})}const h=function(t={}){const{wrapper:e}=Object.assign({},(0,s.ah)(),t.components);return e?(0,i.jsx)(e,Object.assign({},t,{children:(0,i.jsx)(l,t)})):l(t)}},4390:(t,e,n)=>{n.d(e,{Z:()=>i});const i=n.p+"assets/images/workflowPermissions-98b929ca5a94773fe06b6f794842703e.png"},2803:(t,e,n)=>{n.d(e,{Zo:()=>r,ah:()=>o});var i=n(5170);const s=i.createContext({});function o(t){const e=i.useContext(s);return i.useMemo((()=>"function"==typeof t?t(e):{...e,...t}),[e,t])}const a={};function r({components:t,children:e,disableParentContext:n}){let r;return r=n?"function"==typeof t?t({}):t||a:o(t),i.createElement(s.Provider,{value:r},e)}}}]);